# Runbook Template

## Table of Contents

* [General](#general)
* [Observability](#observability)
    * [Logs](#logs)
    * [Metrics](#metrics)
    * [Health Checks](#health-checks)
* [Deployment](#deployment)
    * [Configuration](#configuration)
    * [Required Resources](#required-resources)
    * [Dependencies](#dependencies)
* [Operational Tasks](#operational-tasks)
    * [Sanity Checks](#sanity-checks)
    * [Troubleshooting](#troubleshooting)
* [Events and Errors](#events-and-errors)
    * [Error Message 1](#error-message-1)
        * [Impact to Customers](#impact-to-customers)
        * [Remediation Steps](#remediation-steps)

## General
A quick description of the component,  1 to 2 sentences max.  Why does this
component matter?  What is its core functionality?  What features does it
provide users?

## Observability

### Logs

#### default
Default logger describes the general operational state of the microservice. 
Log level is configured at startup using environment variables or config file.
Changing the log level from the config file on a live system automatically 
updates the log level within the microservice.

#### logger2
Description, how to configure it, how to access its output.

### Metrics
What significant metrics are generated by this component?

### Health Checks

#### ping
An example healthcheck that demonstrates how to add health checks to the
microservice.  It calls the /ping endpoint of the admin server every 15s.  This
healthcheck and entry should not be released to production.

#### healthcheck2
How is the health of this component assessed? How does it report its health?

## Deployment
How is this component deployed?  Is it deployed from microservice stack?  If so, 
what network does it live in? Is there any other initialization that needs to 
occur before this service can run?

### Configuration

#### /etc/{{Name}}.yml
Main service config file

* log.level (`{{replace Name "-" "_" -1 | toUpper}}_LOG_LEVEL`): Log level.
  Defaults to "info".  Changing the log level from the config file on a live
  system updates the log level within the microservice.

* auth.disabled (`{{replace Name "-" "_" -1 | toUpper}}_AUTH_DISABLED`):
  Whether authentication is enforced.  If true, middleware is applied that 
  injects an admin identity into unauthenticated requests.  This setting is for
  development purposes and should not be enabled in production.

* auth.key_file (`{{replace Name "-" "_" -1 | toUpper}}_AUTH_KEY_FILE`): Path
  to the file containing the secret key that is used to validate incoming
  authentication tokens.  This value will be configured by the deployment stack.

* http.port (`{{replace Name "-" "_" -1 | toUpper}}_HTTP_PORT`): Port in which
  the HTTP API service listens.  Defaults to {{Port}}.

* admin.port (`{{replace Name "-" "_" -1 | toUpper}}_ADMIN_PORT`): Port in
  which the Admin API server listens.  Defaults to {{Port}}.  This port should
  only be accessible internally.

* tracing.enabled (`{{replace Name "-" "_" -1 | toUpper}}_TRACING_ENABLED`):
  Forwards tracing to the AWS X-Ray daemon.

* tracing.daemon (`{{replace Name "-" "_" -1 | toUpper}}_TRACING_DAEMON`):
  Address of the AWS X-Ray daemon.

* tracing.sample_rate (`{{replace Name "-" "_" -1 | toUpper}}_TRACING_SAMPLE_RATE`): 
  Rate at which tracing should sample
  requests.

#### filename
What configuration files or environment variables affect this component? How
are they presented to the software (injected by Control Center, set by a run
script, etc.)?

### Required Resources
What resources are needed? What are the minimum and expected maximum sizes (in
cores, RAM bytes, GB disk space, GBit/sec, etc.)?

### Dependencies
Are any third-party or internal dependencies needed for this component to
function? How are they accessed?

## Operational Tasks

### Sanity Checks
What checks can a user perform to ensure that this component is functioning
properly?

### Troubleshooting
How should troubleshooting happen? What tools are available?

## Events and Errors

Every event/error should have a corresponding section, titled by the error
message that identifies the situation.

### Error Message 1
Description:  Why do we have this error?  What does it mean?  What is typically
the cause of this error?

#### Impact to Customers:
How does this situation impact our customers?  If the customers are not being
impacted, this is a good indicator that the level of this error message, if
produced by our logging, should be reduced.

#### Remediation Steps:
Checklist style steps for how to resolve this alert.  A person who has never
worked on our stack should be able to follow these steps and remediate the
incident.  If it cannot be remediated, include escalation steps here. If a KB
article or other external document should be referenced, include a link.
 1. Do this
 2. Check this graph
 3. Do this thing
 4. Do this other thing
 5. Verify service has recovered
